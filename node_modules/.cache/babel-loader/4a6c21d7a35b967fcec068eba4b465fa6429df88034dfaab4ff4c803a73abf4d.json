{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useState, useEffect } from 'react';\nimport { AuthContext } from '../../pages/auth/Auth';\nimport CryptoJS from \"crypto-js\";\n\n//import decrypt from '../crypto/Decryption';\n\nconst useIsAdmin = () => {\n  _s();\n  const {\n    loggedIn\n  } = useContext(AuthContext);\n  const [isAdmin, setIsAdmin] = useState(false);\n  useEffect(() => {\n    const fetchAdminStatus = async () => {\n      try {\n        const loggedInUser = loggedIn; // Replace this with the code to get the logged-in user's username;\n        if (loggedInUser) {\n          const userId = await getUserId(loggedInUser);\n          if (userId) {\n            const isAdminUser = await checkAdmin(userId);\n            setIsAdmin(isAdminUser);\n          } else {\n            setIsAdmin(false); // User ID not found, consider the user as non-admin\n          }\n        }\n      } catch (error) {\n        console.error('Error checking admin status:', error);\n        setIsAdmin(false); // Handle the error gracefully by considering the user as non-admin\n      }\n    };\n\n    fetchAdminStatus();\n  }, [loggedIn]);\n  const secretPass = 'XkhZG4fW2t2W';\n\n  // get user based on username\n  const getUserId = async username => {\n    try {\n      const response = await fetch(`http://localhost:5000/api/username/${username}`);\n      const data = await response.json();\n      if (data && data.encryptedUserId) {\n        const bytes = CryptoJS.AES.decrypt(data.encryptedUserId, secretPass);\n        const decryptedUserId = parseInt(bytes.toString(CryptoJS.enc.Utf8), 10);\n        return decryptedUserId;\n      }\n      return null;\n    } catch (error) {\n      console.error('Error fetching user ID:', error);\n      return null;\n    }\n  };\n\n  // check if admin based on userid\n\n  const checkAdmin = async userId => {\n    try {\n      const response = await fetch(`http://localhost:5000/api/isadmin/${userId}`);\n      const data = await response.json();\n      if (data && data.isAdmin) {\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Error checking admin:', error);\n      return false;\n    }\n  };\n  return isAdmin;\n};\n_s(useIsAdmin, \"Rz2KxrTZCdMMyQseeVe4YPvJ8Zs=\");\nexport default useIsAdmin;\n\n//works","map":{"version":3,"names":["useContext","useState","useEffect","AuthContext","CryptoJS","useIsAdmin","_s","loggedIn","isAdmin","setIsAdmin","fetchAdminStatus","loggedInUser","userId","getUserId","isAdminUser","checkAdmin","error","console","secretPass","username","response","fetch","data","json","encryptedUserId","bytes","AES","decrypt","decryptedUserId","parseInt","toString","enc","Utf8"],"sources":["C:/Users/aodha/OneDrive/Desktop/react-cw/cw4/src/components/isAdmin/isAdmin.js"],"sourcesContent":["import { useContext, useState, useEffect } from 'react';\r\nimport { AuthContext } from '../../pages/auth/Auth';\r\nimport CryptoJS from \"crypto-js\";\r\n\r\n//import decrypt from '../crypto/Decryption';\r\n\r\nconst useIsAdmin = () => {\r\n    const { loggedIn } = useContext(AuthContext);\r\n    const [isAdmin, setIsAdmin] = useState(false);\r\n  \r\n    useEffect(() => {\r\n        const fetchAdminStatus = async () => {\r\n            try {\r\n              const loggedInUser = loggedIn // Replace this with the code to get the logged-in user's username;\r\n              if (loggedInUser) {\r\n                const userId = await getUserId(loggedInUser);\r\n                if (userId) {\r\n                  const isAdminUser = await checkAdmin(userId);\r\n                  setIsAdmin(isAdminUser);\r\n                } else {\r\n                  setIsAdmin(false); // User ID not found, consider the user as non-admin\r\n                }\r\n              }\r\n            } catch (error) {\r\n              console.error('Error checking admin status:', error);\r\n              setIsAdmin(false); // Handle the error gracefully by considering the user as non-admin\r\n            }\r\n          };\r\n        fetchAdminStatus();\r\n      }, [loggedIn]);\r\n  \r\n\r\nconst secretPass = 'XkhZG4fW2t2W';\r\n\r\n// get user based on username\r\nconst getUserId = async (username) => {\r\n  try {\r\n    const response = await fetch(`http://localhost:5000/api/username/${username}`);\r\n    const data = await response.json();\r\n    if (data && data.encryptedUserId) {\r\n      const bytes = CryptoJS.AES.decrypt(data.encryptedUserId, secretPass);\r\n      const decryptedUserId = parseInt(bytes.toString(CryptoJS.enc.Utf8), 10);\r\n      return decryptedUserId;\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error fetching user ID:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n  // check if admin based on userid\r\n\r\n  const checkAdmin = async (userId) => {\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/isadmin/${userId}`);\r\n      const data = await response.json();\r\n      if (data && data.isAdmin) {\r\n        return true;\r\n      }\r\n      return false;\r\n    } catch (error) {\r\n      console.error('Error checking admin:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return isAdmin;\r\n};\r\n\r\nexport default useIsAdmin\r\n\r\n//works"],"mappings":";AAAA,SAASA,UAAU,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACvD,SAASC,WAAW,QAAQ,uBAAuB;AACnD,OAAOC,QAAQ,MAAM,WAAW;;AAEhC;;AAEA,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACrB,MAAM;IAAEC;EAAS,CAAC,GAAGP,UAAU,CAACG,WAAW,CAAC;EAC5C,MAAM,CAACK,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EAE7CC,SAAS,CAAC,MAAM;IACZ,MAAMQ,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACF,MAAMC,YAAY,GAAGJ,QAAQ,EAAC;QAC9B,IAAII,YAAY,EAAE;UAChB,MAAMC,MAAM,GAAG,MAAMC,SAAS,CAACF,YAAY,CAAC;UAC5C,IAAIC,MAAM,EAAE;YACV,MAAME,WAAW,GAAG,MAAMC,UAAU,CAACH,MAAM,CAAC;YAC5CH,UAAU,CAACK,WAAW,CAAC;UACzB,CAAC,MAAM;YACLL,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;UACrB;QACF;MACF,CAAC,CAAC,OAAOO,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpDP,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;MACrB;IACF,CAAC;;IACHC,gBAAgB,EAAE;EACpB,CAAC,EAAE,CAACH,QAAQ,CAAC,CAAC;EAGpB,MAAMW,UAAU,GAAG,cAAc;;EAEjC;EACA,MAAML,SAAS,GAAG,MAAOM,QAAQ,IAAK;IACpC,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,sCAAqCF,QAAS,EAAC,CAAC;MAC9E,MAAMG,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,EAAE;MAClC,IAAID,IAAI,IAAIA,IAAI,CAACE,eAAe,EAAE;QAChC,MAAMC,KAAK,GAAGrB,QAAQ,CAACsB,GAAG,CAACC,OAAO,CAACL,IAAI,CAACE,eAAe,EAAEN,UAAU,CAAC;QACpE,MAAMU,eAAe,GAAGC,QAAQ,CAACJ,KAAK,CAACK,QAAQ,CAAC1B,QAAQ,CAAC2B,GAAG,CAACC,IAAI,CAAC,EAAE,EAAE,CAAC;QACvE,OAAOJ,eAAe;MACxB;MACA,OAAO,IAAI;IACb,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,OAAO,IAAI;IACb;EACF,CAAC;;EAEC;;EAEA,MAAMD,UAAU,GAAG,MAAOH,MAAM,IAAK;IACnC,IAAI;MACF,MAAMQ,QAAQ,GAAG,MAAMC,KAAK,CAAE,qCAAoCT,MAAO,EAAC,CAAC;MAC3E,MAAMU,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,EAAE;MAClC,IAAID,IAAI,IAAIA,IAAI,CAACd,OAAO,EAAE;QACxB,OAAO,IAAI;MACb;MACA,OAAO,KAAK;IACd,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7C,OAAO,KAAK;IACd;EACF,CAAC;EAED,OAAOR,OAAO;AAChB,CAAC;AAACF,EAAA,CA9DID,UAAU;AAgEhB,eAAeA,UAAU;;AAEzB"},"metadata":{},"sourceType":"module","externalDependencies":[]}